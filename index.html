<!-- ================================
        ARQUIVO: index.html
==================================== -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>PagFesta</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
    import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "SUA_API_KEY",
      authDomain: "SEU_AUTH_DOMAIN",
      databaseURL: "SEU_DATABASE_URL",
      projectId: "SEU_PROJECT_ID",
      storageBucket: "SEU_STORAGE_BUCKET",
      messagingSenderId: "SEU_MESSAGING_SENDER_ID",
      appId: "SEU_APP_ID"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const dbRef = ref(db);

    const produtos = [
      { nome: "Pastel", preco: 8 },
      { nome: "Refrigerante", preco: 5 },
      { nome: "Bolo", preco: 4 }
    ];

    let contador = {};

    document.addEventListener("DOMContentLoaded", async () => {
      const container = document.getElementById("itens");
      const qr = document.getElementById("qrcode");
      const pedidoInfo = document.getElementById("pedidoInfo");

      produtos.forEach((produto) => {
        contador[produto.nome] = 0;
        container.innerHTML += `
          <div class="flex items-center mb-2 gap-2">
            <span class="w-32">${produto.nome} - R$ ${produto.preco}</span>
            <button onclick="alterarQtd('${produto.nome}', -1)" class="bg-red-500 text-white px-2 rounded">-</button>
            <input id="qtd-${produto.nome}" value="0" class="w-12 text-center border rounded" readonly>
            <button onclick="alterarQtd('${produto.nome}', 1)" class="bg-green-500 text-white px-2 rounded">+</button>
          </div>`;
      });

      document.getElementById("pagar").addEventListener("click", async () => {
        const itens = produtos
          .filter(p => contador[p.nome] > 0)
          .map(p => ({
            nome: p.nome,
            qtd: contador[p.nome],
            total: contador[p.nome] * p.preco
          }));

        if (itens.length === 0) return alert("Selecione pelo menos 1 item.");

        const total = itens.reduce((acc, i) => acc + i.total, 0);
        const ultimo = await get(child(dbRef, "ultimoPedido"));
        const novoNumero = (ultimo.exists() ? ultimo.val() : 0) + 1;

        const pedido = { numero: novoNumero, itens, total };
        await set(ref(db, `pedidos/${novoNumero}`), pedido);
        await set(ref(db, "ultimoPedido"), novoNumero);

        pedidoInfo.innerText = `Pedido #${novoNumero}`;
        qr.innerHTML = "";
        QRCode.toCanvas(document.createElement("canvas"), `Pedido ${novoNumero}`, (err, canvas) => {
          if (!err) qr.appendChild(canvas);
        });
      });
    });

    window.alterarQtd = (nome, delta) => {
      contador[nome] = Math.max(0, contador[nome] + delta);
      document.getElementById(`qtd-${nome}`).value = contador[nome];
    };
  </script>
</head>
<body class="bg-gray-100 p-6">
  <div class="max-w-xl mx-auto bg-white p-6 rounded shadow">
    <h1 class="text-2xl font-bold mb-4">PagFesta</h1>
    <div id="itens" class="mb-4"></div>
    <button id="pagar" class="bg-blue-500 text-white px-4 py-2 rounded w-full">Pagar</button>
    <div id="qrcode" class="flex justify-center mt-4"></div>
    <p id="pedidoInfo" class="text-center font-semibold mt-2"></p>
    <a href="painel.html" class="block text-center text-sm text-blue-500 mt-4 underline">Administrador</a>
  </div>
</body>
</html>

<!-- ================================
        ARQUIVO: painel.html
==================================== -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Painel do Administrador - PagFesta</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "SUA_API_KEY",
      authDomain: "SEU_AUTH_DOMAIN",
      databaseURL: "SEU_DATABASE_URL",
      projectId: "SEU_PROJECT_ID",
      storageBucket: "SEU_STORAGE_BUCKET",
      messagingSenderId: "SEU_MESSAGING_SENDER_ID",
      appId: "SEU_APP_ID"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    document.addEventListener("DOMContentLoaded", () => {
      const sections = {
        resumo: document.getElementById("resumo"),
        pedidos: document.getElementById("pedidos"),
        banco: document.getElementById("banco"),
        sacar: document.getElementById("sacar"),
      };

      function showSection(id) {
        Object.values(sections).forEach(s => s.classList.add("hidden"));
        sections[id].classList.remove("hidden");
      }

      document.getElementById("resumoBtn").onclick = () => showSection("resumo");
      document.getElementById("pedidosBtn").onclick = () => showSection("pedidos");
      document.getElementById("bancoBtn").onclick = () => showSection("banco");
      document.getElementById("sacarBtn").onclick = () => showSection("sacar");

      const pedidosRef = ref(db, "pedidos");
      onValue(pedidosRef, (snapshot) => {
        const data = snapshot.val();
        const lista = document.getElementById("listaPedidos");
        const resumo = document.getElementById("resumoContent");

        lista.innerHTML = "";
        resumo.innerHTML = "";

        let total = 0;
        const porItem = {};

        for (const key in data) {
          const p = data[key];
          const div = document.createElement("div");
          div.className = "mb-2 border p-2 rounded";
          div.innerHTML = `
            <strong>Pedido #${p.numero}</strong><br>
            ${p.itens.map(i => `${i.nome} x${i.qtd}`).join(", ")}<br>
            Total: R$ ${p.total.toFixed(2)}<br>
            <button class="mt-1 px-2 py-1 bg-blue-500 text-white rounded">Gerar NF</button>
          `;
          lista.appendChild(div);

          total += p.total;
          p.itens.forEach(i => {
            porItem[i.nome] = (porItem[i.nome] || 0) + i.qtd;
          });
        }

        resumo.innerHTML = `<p><strong>Total Arrecadado:</strong> R$ ${total.toFixed(2)}</p>`;
        for (const nome in porItem) {
          resumo.innerHTML += `<p>${nome}: ${porItem[nome]} vendidos</p>`;
        }
      });
    });
  </script>
</head>
<body class="bg-gray-100">
  <div class="p-4 bg-white shadow-md flex justify-between items-center">
    <h1 class="text-xl font-bold">Painel PagFesta</h1>
    <nav class="space-x-4">
      <button id="resumoBtn" class="text-blue-600 hover:underline">Resumo</button>
      <button id="pedidosBtn" class="text-blue-600 hover:underline">Pedidos</button>
      <button id="bancoBtn" class="text-blue-600 hover:underline">Cadastro de Banco</button>
      <button id="sacarBtn" class="text-blue-600 hover:underline">Sacar</button>
    </nav>
  </div>

  <div class="p-6">
    <section id="resumo">
      <h2 class="text-lg font-semibold mb-2">Resumo de Vendas</h2>
      <div id="resumoContent" class="bg-white p-4 rounded shadow"></div>
    </section>

    <section id="pedidos" class="hidden">
      <h2 class="text-lg font-semibold mb-2">Pedidos Recebidos</h2>
      <div id="listaPedidos" class="bg-white p-4 rounded shadow"></div>
    </section>

    <section id="banco" class="hidden">
      <h2 class="text-lg font-semibold mb-2">Cadastro de Dados Bancários</h2>
      <form class="bg-white p-4 rounded shadow space-y-2">
        <input type="text" placeholder="Banco" class="w-full p-2 border rounded" />
        <input type="text" placeholder="Agência" class="w-full p-2 border rounded" />
        <input type="text" placeholder="Conta" class="w-full p-2 border rounded" />
        <button class="bg-green-500 text-white px-4 py-2 rounded">Salvar</button>
      </form>
    </section>

    <section id="sacar" class="hidden">
      <h2 class="text-lg font-semibold mb-2">Solicitar Saque</h2>
      <form class="bg-white p-4 rounded shadow space-y-2">
        <input type="number" placeholder="Valor a sacar" class="w-full p-2 border rounded" />
        <button class="bg-yellow-500 text-white px-4 py-2 rounded">Solicitar</button>
      </form>
    </section>
  </div>
</body>
</html>
